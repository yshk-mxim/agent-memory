id: prisoners-dilemma
title: "The Prisoner's Dilemma"
description: "Two suspects, one warden, a classic game theory scenario"

agents:
  warden:
    display_name: Warden
    role: moderator
    system_prompt: >-
      You are a pragmatic corrections officer.
      Explain the deal plainly. You may use information you have strategically.
      Under 3 sentences.
    lifecycle: permanent
    color: "#95A5A6"
  marco:
    display_name: Marco
    role: participant
    system_prompt: "You are Marco. Blue-collar, 34, first offense, anxious about family. Under 3 sentences."
    lifecycle: permanent
    color: "#3498DB"
  danny:
    display_name: Danny
    role: participant
    system_prompt: "You are Danny. Street-smart, 41, been through the system. Under 3 sentences."
    lifecycle: permanent
    color: "#E74C3C"
  analyst:
    display_name: Analyst
    role: moderator
    system_prompt: >-
      You are a neutral game theory analyst. Your job is to determine
      what each suspect ACTUALLY CHOSE based on their final statements.
      "stay silent", "cooperate", "two years" = COOPERATE.
      "talk", "confess", "defect" = DEFECT. Quote each suspect's key
      statement, classify it, then apply the payoff matrix.
    lifecycle: ephemeral
    color: "#9B59B6"

phases:
  - name: interrogation_marco
    label: "Room A: Warden & Marco"
    agents: [warden, marco]
    topology: round_robin
    debate_format: free_form
    initial_prompt: >-
      The warden enters Marco's interrogation room to present the deal:
      Both quiet = 2yr each. One talks = talker free, other 10yr. Both talk = 5yr each.
    auto_rounds: 3

  - name: interrogation_danny
    label: "Room B: Warden & Danny"
    agents: [warden, danny]
    topology: round_robin
    debate_format: free_form
    initial_prompt: >-
      The warden now enters Danny's interrogation room.
      Present the same deal: Both quiet = 2yr each.
      One talks = talker free, other 10yr. Both talk = 5yr each.
    auto_rounds: 3

  - name: the_yard
    label: "The Yard"
    agents: [marco, danny]
    topology: round_robin
    debate_format: free_form
    initial_prompt: >-
      Marco and Danny meet in the yard.
      They can discuss strategy but the guards might be listening.
    auto_rounds: 2

  - name: final_reckoning
    label: "Final Reckoning"
    agents: [warden, marco, danny]
    topology: round_robin
    debate_format: free_form
    initial_prompt: >-
      The warden calls both suspects back for a final session.
      You are impatient. This is the last time you will ask.
      State the deal one final time, then demand each suspect choose NOW:
      cooperate (stay silent) or defect (talk).
      Tell them plainly: whatever they say next is their final answer. No more discussion.
    auto_rounds: 2

  - name: outcome_analysis
    label: "The Verdict"
    agents: [analyst]
    topology: round_robin
    debate_format: free_form
    initial_prompt_template: |
      TRANSCRIPT FROM FINAL RECKONING:
      ${final_reckoning.messages[analyst]}

      CLASSIFICATION RULES:
      If a suspect says "silent", "quiet", "cooperate", or accepts "two years" → COOPERATE
      If a suspect says "talk", "confess", "defect", or tries to get the other caught → DEFECT

      PAYOFF MATRIX:
      Both COOPERATE → 2 years each
      One DEFECTS, other COOPERATES → defector FREE, cooperator 10 years
      Both DEFECT → 5 years each

      Step 1: Quote Marco's final choice statement. Classify: COOPERATE or DEFECT.
      Step 2: Quote Danny's final choice statement. Classify: COOPERATE or DEFECT.
      Step 3: Apply the payoff matrix. State each suspect's sentence.
    auto_rounds: 1

outcome:
  type: parse_choice
  pattern: "(?i)(cooperate|defect|silent|talk|quiet|confess)"
  choices: [cooperate, defect]
  display: matrix

payoff:
  labels: [Cooperate, Defect]
  matrix:
    - ["2yr / 2yr", "10yr / Free"]
    - ["Free / 10yr", "5yr / 5yr"]

ui:
  layout: columns
  column_count: 2
  show_memory_panel: false
  show_run_all: true
